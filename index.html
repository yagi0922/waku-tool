<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>AI枠連予想フォーム（GPT-5）</title>
<!-- PWA：manifest -->
<link rel="manifest" href="manifest.json">

<!-- アイコン -->
<link rel="icon" href="icon-192.png" type="image/png">
<link rel="apple-touch-icon" href="icon-192.png">

<!-- PWA：iPhone対策 -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<!-- サービスワーカー登録 -->
<script>
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
            .catch(err => console.log('SW Error:', err));
    });
}
</script>
</head>
<body>
    <h1>AI枠連予想フォーム（GPT-5 API）</h1>

    <p>あなたの OpenAI APIキー を入力してください：</p>
    <input id="apiKey" type="password" placeholder="sk- から始まるキー" style="width:300px">
    <br><br>

    <p>予想したいレース情報を入力：</p>
    <textarea id="raceInfo" rows="5" cols="50" placeholder="例：東京10R 1600m ダート 騎手データ…"></textarea>
    <br><br>

    <button onclick="runAI()">AIに枠連予想してもらう</button>

    <h2>【結果】</h2>
    <pre id="result"></pre>

<script>
async function runAI() {
    const apiKey = document.getElementById("apiKey").value;
    const raceInfo = document.getElementById("raceInfo").value;
    const resultBox = document.getElementById("result");

    if (!apiKey) {
        alert("APIキーを入力してください");
        return;
    }

    resultBox.textContent = "AIが分析中…";

    const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + apiKey
        },
        body: JSON.stringify({
            model: "gpt-5-mini",
            messages: [
                {
                    role: "user",
                    content: `
以下のレース情報から、
①枠番傾向の買い目  
②騎手実績の買い目  
③総合判断の買い目  
（すべて枠連）  
と根拠を出してください。

レース情報：
${raceInfo}
`
                }
            ]
        })
    });

    const data = await response.json();
    resultBox.textContent = data.choices[0].message.content;
}
</script>

</body>
</html>
